name: Build MIPS Gaming Toolkit

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Install Toolchain
        run: |
          sudo apt-get update
          sudo apt-get install -y gcc-mipsel-linux-gnu make git

      - name: Compile all C files for MIPS
        run: |
          for file in *.c; do
            # Extract the name without .c (e.g., sysinfo.c -> sysinfo)
            filename=$(basename "$file" .c)
            
            echo "Compiling $file..."
            
            # Compile with -static for the MIPS handheld
            mipsel-linux-gnu-gcc -static "$file" -o "${filename}_mips"
          done

      - name: Upload Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: mips-binaries
          path: "*_mips"


      - name: Upload Binaries
        uses: actions/upload-artifact@v4
        with:
          name: mips-gaming-pack
          path: |
            sysinfo_mips
            rkgame
            fbdoom_mips
